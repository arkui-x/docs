How to Package the ArkUI-X SDK

# Overview

This tutorial describes how to extend the OpenHarmony ArkUI development framework to different OS platforms like Android and iOS. This way, you can reuse most of the app code (UI and main app logic) based on the ArkUI and deploy the code on the corresponding OS platform to facilitate cross-platform app development.

The ArkUI-X SDK comes with the ArkUI cross-platform runtime, component and API plug-in packages, and ACE Tools, which help you to develop ArkUI-X apps and deploy them on Android or iOS. The source code directory structure is as follows:

```
ArkUI-X SDK
├── engine                   // ArkUI-X engine library
│   ├── lib                  // Dynamic libraries of the Android platform and architecture
│   ├── framework            // Framework libraries of the iOS platform and architecture
│   ├── xcframework          // XCFramework libraries of the iOS platform and architecture
│   ├── ets                  // ArkUI-X incremental APIs, for example, @arkui-x.bridge
│   ├── apiConfig.json       // Engine library configuration file, which is parsed by the IDE and ACE Tools to support on-demand packaging for app building
│   └── systemres            // System resources provided by the ArkUI-X framework
├── plugins                  // Plug-ins provided by ArkUI-X
│   ├── component            // ArkUI component plug-in library and engine library configuration file apiConfig.json
│   └── api                  // @ohos API plug-in library and engine library configuration file apiConfig.json
├── toolchains               // ArkUI-X app development tools, for example, ACE Tools
├── sdkConfig.json           // Incremental d.ts path and API prefix configuration.
├── arkui-x.json             // SDK management configuration, which is automatically generated by the pipeline
└── NOTICE.txt
```

>For details about the internal structure of ArkUI-X SDK, see [ArkUI-X SDK Directory Structure](../../application-dev/quick-start/sdk-structure-guide.md).

The following describes how to configure the ArkUI-X SDK trustlist, build and generate the ArkUI-X SDK, and verify the generated ArkUI-X SDK.

## ArkUI-X SDK Configuration

This section uses the cross-platform implementation of the [@ohos.i18n(Internationalization-I18n)](https://gitcode.com/openharmony/docs/blob/master/en/application-dev/reference/apis-localization-kit/js-apis-i18n.md) APIs as an example to describe how to configure the ArkUI-X SDK trustlist.

### Cross-platform Implementation of @ohos.i18n APIs

- ArkUI-X community code repository: **https://gitcode.com/arkui-x/plugins**

- Code repository for cross-platform implementation of @ohos.i18n APIs: **https://gitcode.com/arkui-x/plugins/tree/ArkUI-X-5.0.2-Release/i18n**

For details about @ohos.i18n API definitions, see [How to Extend @ohos APIs on Android](how-to-achieve-arkts-interface-on-android.md) and [How to Extend @ohos APIs on iOS](how-to-achieve-arkts-interface-on-ios.md).

- After defining the @ohos.i18n APIs for cross-platform implementation, configure the static link targets **i18n_static_android** and **i18n_static_ios** in [BUILD.gn](https://gitcode.com/arkui-x/plugins/blob/ArkUI-X-5.0.2-Release/i18n/BUILD.gn). According to the module naming rule, set the name of the @ohos.i18n API module to **i18n**, and configure it in [common_plugin_libs](https://gitcode.com/arkui-x/plugins/blob/ArkUI-X-5.0.2-Release/plugin_lib.gni) as the input for the **plugin_lib** template. 

- Call the **plugin_lib** template in the [arkui_for_android](https://gitcode.com/arkui-x/arkui_for_android/blob/ArkUI-X-5.0.2-Release/build/BUILD.gn) and [arkui_for_ios](https://gitcode.com/arkui-x/arkui_for_ios/blob/ArkUI-X-5.0.2-Release/build/BUILD.gn) repositories. Dynamic link targets are generated as follows:
  - //foundation/arkui/ace_engine/adapter/android/build:i18n
  - //foundation/arkui/ace_engine/adapter/ios/build:libi18n

- Because Android APIs are involved in this implementation, also provide the Java Library GN targets, which are available in **//plugins/i18n/android/java:i18n_plugin_java**.

### @ohos.i18n SDK Build Trustlist Configuration

After defining the @ohos.i18n APIs for cross-platform implementation, you need to configure the trustlist in the [plug-in repository](https://gitcode.com/arkui-x/build_plugins) and package the trustlist into the ArkUI-X SDK during the build process.

[Trustlist configuration for Android](https://gitcode.com/arkui-x/build_plugins/blob/ArkUI-X-5.0.2-Release/sdk/arkui_cross_sdk_description_std.json)

```json
    {
        "install_dir": "arkui-x/plugins/api/lib/i18n/arch_type",                     // ArkUI-X SDK directory for data output
        "module_label": "//foundation/arkui/ace_engine/adapter/android/build:i18n",  // SO dynamic libraries that need to be packaged into the ArkUI-X SDK
        "target_os": [
            "linux",
            "windows",
            "darwin"
        ]
    },
    {
        "install_dir": "arkui-x/plugins/api/lib/i18n",                               // ArkUI-X SDK directory for data output
        "module_label": "//plugins/i18n/android/java:i18n_plugin_java",              // Jar packages that need to be packaged into the ArkUI-X SDK
        "target_os": [
            "linux",
            "windows",
            "darwin"
        ]
    },
```

[Trustlist configuration for iOS](https://gitcode.com/arkui-x/build_plugins/blob/ArkUI-X-5.0.2-Release/sdk/arkui_cross_sdk_description_std.json)

```json
    {
        "install_dir": "arkui-x/plugins/api/framework/arch_type/libi18n.framework",   // ArkUI-X SDK directory for data output
        "module_label": "//foundation/arkui/ace_engine/adapter/ios/build:libi18n", // Framework dynamic libraries that need to be packaged into the ArkUI-X SDK
        "target_os": [
            "darwin"
            ]
    },
```

### @ohos.i18n API Call Parsing

Both the **engine** and **plugins** directories in the ArkUI-X SDK contain the **apiConfig.json** file, which is used for API call parsing by DevEco Studio and ACE Tools. This way, you can just focus on ArkTS code development, without the need to consider the referenced ArkUI controls and @ohos API plug-ins. This section describes only how to configure the **apiConfig.json** file in the [SDK repository](https://gitcode.com/arkui-x/interface_sdk). Introduction to the **apiConfig.json** file is not provided.

```json
    {
        "module": "ohos.i18n", // OpenHarmony i18n API module, that is, @ohos.i18n
        "library": {
            "android": [                                                 // Libraries that need to be packaged into the Android app package during i18n app development on Android
                "lib/i18n/ace_i18n_plugin_android.jar",
                "lib/i18n/arch_type/libi18n.so"
            ],
            "ios":[ "xcframework/build_modes/libi18n.xcframework" ]      // Libraries that need to be packaged into the iOS app package during i18n app development on iOS
        },
        "deps": {
            "android": [],                                               // Dependent libraries that need to be packaged into the Android app package during i18n app development on Android
            "ios":[]                                                     // Dependent libraries that need to be packaged into the iOS app package during i18n app development on iOS
        }
    },
```

## ArkUI-X SDK Building

Use the commands provided in [Building an ArkUI-X Project](../quick-start/start-with-build.md) to build the ArkUI-X SDK.

### Linux

- Build the ArkUI-X Debug, Release, and Profile integrated version. This method applies only to Android.
```
./build.sh --product-name arkui-x --target-os android --gn-args enable_auto_pack=true
```

- Build the ArkUI-X Release version. This method applies only to Android.
```
./build.sh --product-name arkui-x --target-os android --gn-args enable_auto_pack=true runtime_mode=release
```

### Mac

#### Android and iOS

- Build the ArkUI-X Debug, Release, and Profile integrated version. This method applies both to Android and iOS.
```
./build.sh --product-name arkui-x --target-os ios --gn-args enable_auto_pack=true build_android=true
```

- Build the ArkUI-X Release version. This method applies both to Android and iOS.
```
./build.sh --product-name arkui-x --target-os ios --gn-args enable_auto_pack=true runtime_mode=release build_android=true
```

#### iOS

- Build ArkUI-X Debug, Profile, and Release integrated version. This method applies only to iOS.
```
./build.sh --product-name arkui-x --target-os ios --gn-args enable_auto_pack=true
```

- Build the ArkUI-X Release version. This method applies only to iOS.
```
./build.sh --product-name arkui-x --target-os ios --gn-args enable_auto_pack=true runtime_mode=release
```

#### Android

- Build the ArkUI-X Debug, Release, and Profile integrated version. This method applies only to Android.
```
./build.sh --product-name arkui-x --target-os android --gn-args enable_auto_pack=true
```

- Build the ArkUI-X Release version. This method applies only to Android.
```
./build.sh --product-name arkui-x --target-os android --gn-args enable_auto_pack=true runtime_mode=release
```

## ArkUI-X SDK Debugging

- Check for the ArkUI-X SDK build output in **out/arkui-x/packages/arkui-x**.

- Replace the ArkUI-X SDK installed on the existing Windows, macOS, or Linux platform. Note: If you use ACE Tools for app project building and debugging, you need to download the ACE command dependency again. For details, see [ACE Installation Commands](../../application-dev/quick-start/start-with-ace-tools.md).
